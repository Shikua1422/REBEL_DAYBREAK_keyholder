<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Now Playing</title>

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
  background: #111;
  color: #fff;
}

/* ===== ヘッダー ===== */
.header {
  position: fixed;
  top: 12px;
  right: 16px;
  z-index: 40;
}
.menu-btn {
  font-size: 26px;
  cursor: pointer;
}

/* ===== ディスク交換 ===== */
.eject {
  position: fixed;
  top: 14px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 20px;
  opacity: 0.6;
  cursor: pointer;
  z-index: 40;
}
.eject:hover { opacity: 1; }

/* ===== ディスク選択 ===== */
.disk-panel {
  position: fixed;
  top: 50px;
  left: 50%;
  transform: translateX(-50%);
  background: #181818;
  border-radius: 10px;
  padding: 10px;
  display: none;
  z-index: 50;
}
.disk-panel.open { display: block; }
.disk-item {
  padding: 8px 14px;
  cursor: pointer;
  border-radius: 6px;
}
.disk-item:hover {
  background: #333;
}

/* ===== プレイリスト ===== */
.playlist {
  position: fixed;
  top: 0;
  right: -100%;
  width: 260px;
  height: 100%;
  background: #181818;
  padding: 20px;
  transition: right 0.35s ease;
  z-index: 35;
}
.playlist.open { right: 0; }
.track {
  padding: 10px;
  border-radius: 6px;
  cursor: pointer;
}
.track.active { background: #333; }
.track span {
  display: block;
  font-size: 12px;
  color: #aaa;
}

/* ===== メイン ===== */
.container {
  padding: 44px 15px 20px;
  text-align: center;
}

.stage {
  position: relative;
  width: 300px;
  height: 300px;
  margin: 20px auto;
}

/* ===== 動画 ===== */
.video {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 220px;
  height: 124px;
  transform: translate(-50%, -50%);
  pointer-events: none;
  z-index: 1;
}
.stage.cd-mini .video {
  width: 360px;
  height: 202px;
}

/* ===== CD ===== */
.cd {
  position: absolute;
  inset: 0;
  border-radius: 50%;
  background: url("cd.jpeg") center/cover no-repeat;
  animation: spin 10s linear infinite;
  animation-play-state: paused;
  cursor: pointer;
  z-index: 5;
  transition: all 0.45s ease;
}
.cd.mini {
  width: 58px;
  height: 58px;
  top: -60px;
  left: -30px;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* ===== 情報 ===== */
.title {
  font-size: 18px;
  margin-top: 10px;
}
.artist {
  font-size: 14px;
  color: #aaa;
}

.title-link {
  color: #fff;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  opacity: 0.85;
  position: relative;
}
.youtube-icon {
  width: 14px;
  height: 14px;
  opacity: 0.6;
  position: absolute;
  right: -20px;
}

/* ===== コントロール ===== */
.controls { margin-top: 18px; }

.control-buttons {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 22px;
  margin-bottom: 10px;
}

.icon-btn,
.play-btn {
  background: none;
  border: none;
  cursor: pointer;
}

.icon-btn svg {
  width: 22px;
  height: 22px;
  fill: #aaa;
}
.icon-btn:hover svg { fill: #fff; }

.play-btn {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: #fff;
}

@keyframes glowCycle {
  0% { box-shadow: 0 0 12px rgba(255,255,255,.7); }
  100% { box-shadow: 0 0 12px rgba(255,255,255,.7); }
}
body.playing .play-btn {
  animation: glowCycle 6s infinite;
}

/* ===== シークバー ===== */
.seekbar {
  width: 100%;
  height: 4px;
  background: linear-gradient(
    to right,
    #fff 0%,
    #fff var(--progress,0%),
    #444 var(--progress,0%),
    #444 100%
  );
}
</style>
</head>

<body>

<div class="header">
  <div class="menu-btn" onclick="toggleList()">☰</div>
</div>

<div class="eject" onclick="toggleDisk()">⏏️</div>
<div class="disk-panel" id="diskPanel"></div>

<div class="playlist" id="playlist"></div>

<div class="container">
  <div class="stage">
    <div id="player" class="video"></div>
    <div id="cd" class="cd"></div>
  </div>

  <div class="title">
    <a id="titleLink" class="title-link" target="_blank">
      <span id="title"></span>
      <svg class="youtube-icon" viewBox="0 0 24 24">
        <path d="M9.6 14.6V7.9l6.4 3.4z"/>
      </svg>
    </a>
  </div>
  <div class="artist" id="artist"></div>

  <div class="controls">
    <div class="control-buttons">
      <button class="icon-btn" onclick="prev()">⏮</button>
      <button class="play-btn" onclick="toggle()">▶</button>
      <button class="icon-btn" onclick="next()">⏭</button>
    </div>
    <input type="range" id="seekbar" class="seekbar">
  </div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
const albums = [
  {
    name: "REBEL DISC 1",
    tracks: [
      { id: "HCoTcCMLRsM", title: "Q", artist: "REBEL" },
      { id: "p8iNb7sTNiY", title: "ロストワンの号哭", artist: "REBEL" },
      { id: "uC44M7_srjg", title: "DOGLAND", artist: "REBEL" }
    ]
  },
  {
    name: "REBEL DISC 2",
    tracks: [
      { id: "HCoTcCMLRsM", title: "Q (Alt)", artist: "REBEL" }
    ]
  }
];

let diskIndex = 0;
let album = albums[0].tracks;
let index = 0;
let player;

function onYouTubeIframeAPIReady() {
  player = new YT.Player("player", {
    videoId: album[0].id,
    playerVars: { playsinline: 1, controls: 0 },
    events: { onReady }
  });
}

function onReady() {
  renderList();
  updateInfo();
  renderDisks();
}

function renderDisks() {
  const p = document.getElementById("diskPanel");
  p.innerHTML = "";
  albums.forEach((d, i) => {
    const div = document.createElement("div");
    div.className = "disk-item";
    div.textContent = d.name;
    div.onclick = () => switchDisk(i);
    p.appendChild(div);
  });
}

function toggleDisk() {
  document.getElementById("diskPanel").classList.toggle("open");
}

function switchDisk(i) {
  diskIndex = i;
  album = albums[i].tracks;
  index = 0;
  player.loadVideoById(album[0].id);
  updateInfo();
  renderList();
  toggleDisk();
}

function updateInfo() {
  title.textContent = album[index].title;
  artist.textContent = album[index].artist;
  titleLink.href = "https://www.youtube.com/watch?v=" + album[index].id;
}

function renderList() {
  playlist.innerHTML = "<h3>アルバム</h3>";
  album.forEach((t,i)=>{
    const d=document.createElement("div");
    d.className="track"+(i===index?" active":"");
    d.innerHTML=`${t.title}<span>${t.artist}</span>`;
    d.onclick=()=>loadTrack(i);
    playlist.appendChild(d);
  });
}

function loadTrack(i){
  index=i;
  player.loadVideoById(album[i].id);
  updateInfo();
  renderList();
}
function next(){ loadTrack((index+1)%album.length); }
function prev(){ loadTrack((index-1+album.length)%album.length); }
function toggleList(){ playlist.classList.toggle("open"); }
</script>

</body>
</html>
